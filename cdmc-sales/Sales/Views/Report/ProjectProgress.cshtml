@{
    ViewBag.Title = "项目进展";
}
@Html.Partial("contenttitle", "项目进展")

@using Model
@model List<AjaxViewProjecMonthPerformance>
 @Html.Partial("progressselector")    
 @{
  var selectedangels = ViewBag.SelectedAngels as List<string>;
 foreach (var pv in Model)
 { 
     <fieldset >
     <legend> @pv.ProjectName
     </legend>
      @if (selectedangels ==null || selectedangels.Contains("week"))
      {
          foreach (AjaxViewProjectWeekPerformance wv in pv.AjaxViewProjectWeekPerformances)
          {
              var m = new List<AjaxViewProjectWeekPerformance>();
              m.Add(wv);
              <fieldset  style="width:22.1%;float:left;">
              <legend>@wv.StartDate.ToShortDateString() ~ @wv.EndDate.ToShortDateString()</legend>
              
               @(Html.Telerik().Chart<AjaxViewProjectWeekPerformance>(m).Name("chart" + wv.StartDate.ToShortDateString()).Title(wv.ProjectName).Legend(legend => legend.Position(ChartLegendPosition.Bottom)).Series(series =>
  {
      series.Column(s => s.DealInTarget).Name("销售目标").Labels(true);
      series.Column(s => s.DealIn).Name("实际出单").Labels(true);
      series.Column(s => s.CheckInTarget).Name("入账目标").Labels(true);
      series.Column(s => s.CheckIn).Name("实际入账").Labels(true);

      //series.Bar(s => s.DealInTarget).Name("销售目标").Labels(labels => labels.Template(" 销售目标: <#= value #>").Visible(true));
      //series.Bar(s => s.DealIn).Name("实际出单").Labels(labels => labels.Template(" 实际出单: <#= value #>").Visible(true));
      //series.Bar(s => s.CheckInTarget).Name("入账目标").Labels(labels => labels.Template(" 入账目标: <#= value #>").Visible(true));
      //series.Bar(s => s.CheckIn).Name("实际入账").Labels(labels => labels.Template(" 实际入账: <#= value #>").Visible(true));

  })
  .CategoryAxis(axis => axis.Categories(s => s.ComplatePercentage))
  .ValueAxis(axis => axis.Numeric().Labels(labels => labels.Format("￥{0:#,##0}")))
      )
              </fieldset> 
          }
      }
     </fieldset>
 }
 }

@*@Html.Partial("multipleprojectselector")
<fieldset>
<legend>项目进展报表</legend>
@if (Model != null)
{
    var height = 100 + Model.Count() * 150;
      @(Html.Telerik().Chart(Model).Name("chart").Title("项目进展报表").Legend(legend => legend.Position(ChartLegendPosition.Top)).Series(series =>
  {
      series.Bar(s => s.DealInTarget).Name("销售目标").Labels(labels => labels.Template(" 销售目标: <#= value #>").Visible(true));
      series.Bar(s => s.DealIn).Name("实际出单").Labels(labels => labels.Template(" 实际出单: <#= value #>").Visible(true));
      series.Bar(s => s.CheckInTarget).Name("入账目标").Labels(labels => labels.Template(" 入账目标: <#= value #>").Visible(true));
      series.Bar(s => s.CheckIn).Name("实际入账").Labels(labels => labels.Template(" 实际入账: <#= value #>").Visible(true));
      series.Bar(s => s.Project.Target).Name("总目标").Labels(labels => labels.Template(" 总目标: <#= value #>").Visible(true));
      series.Bar(s => s.TotalDealIn).Name("实际销售总额").Labels(labels => labels.Template(" 实际销售总额: <#= value #>").Visible(true)).Color("red");
      series.Bar(s => s.TotalCheckIn).Name("实际入账总额").Labels(labels => labels.Template(" 实际入账总额: <#= value #>").Visible(true)).Color("yellow");

  }).CategoryAxis(axis => axis.Categories(s => s.NameWithCompletePercentage)).ValueAxis(axis => axis.Numeric().Labels(labels => labels.Format("￥{0:#,##0}"))).HtmlAttributes(new { style = "height:" + height + "px" })
      )
  
} 
</fieldset>  *@ 