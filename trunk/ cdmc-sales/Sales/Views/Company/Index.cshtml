@using Entity
@using Utl
@model List<Company>
@(Html.Telerik().Grid(Model).Name("Company")
                .DataKeys(keys =>
                {
                    keys.Add(s => s.ID);
                })
                .Columns(c =>
                {
                    c.Bound(item => item.Name).Width(150);
                    c.Bound(item => item.Contact).Width(150);
                    c.Bound(item => item.Area.Name).Width(100);
                    c.Bound(item => item.CompanyType.Name).Width(100);
                    c.Bound(item => item.ID).Title("操作").Template(@<span>
                    <a href=@Url.Content("~/Company/Edit/" + item.ID) >编辑</a> | <a href=@Url.Content("~/Company/Details/" + item.ID)>详细</a>  | <a href=@Url.Content("~/Client/Create/?CompanyId=" + item.ID)>添加客户</a>| <a href=@Url.Content("~/Company/delete/" + item.ID) >删除</a> 
                   </span>);
                })
                .DetailView(e => e.Template(
                        @<text>
                         @RenderGrid(item.Clients, item.ID)
                        </text>
                    ))
                .Resizable(resizing => resizing.Columns(true))
                .Groupable()
                .Pageable(p => p.PageSize(20))
                .Sortable()
                .Filterable()
                .Scrollable(scrolling => scrolling.Height(350))
                        )


@Html.ActionLink("公司创建", "Create")

@helper RenderGrid(List<Client> clients, int companyuid)
    { 
     @(Html.Telerik().Grid(clients).Name("clients" + companyuid)
                            .Columns(c =>
                            {
                                c.Template(@<text><img alt=@item.ClientImageID style="width:130px;height:100px" src=@Url.Content("~/Image/DisplayClientImage/" + item.ClientImageID) /></text>).Title("客户照片").Width(150);
                                c.Bound(o => o.Name).Width(140);
                                c.Bound(o => o.Title).Width(140);
                                c.Bound(o => o.Contact).Width(200);
                            })
                        .Resizable(resizing => resizing.Columns(true))
                        .Pageable(p => p.PageSize(20))
                        .Sortable())
} 
