@using Entity
@using Utl
@model List<Lead>
@Html.Partial("contenttitle", "客户邮箱")
@using (Html.BeginForm())
{
<div  style="margin:10px; margin-left:0px;">
        <span ><b>目标项目：</b>
        @{
    var ps = CH.GetAllData<Project>(p => p.Market == Employee.CurrentUserName);
            var selected = ps.Count== 0 ? 0:ps.FirstOrDefault().ID;
        @Html.DropDownList("ProjectID", new SelectList(ps, "ID", "ProjectCode", selected), new { onchange = "this.form.submit();" })
}
            </span>
       </div>
}
@(Html.Telerik().Grid<Lead>(Model).Name("Lead")
     .ToolBar(commands => commands.Custom().HtmlAttributes(new { id = "export" }).Text("导出excel格式数据").Action("EmailExportCsv", "MarketInterface", new { projectid = (int?)ViewBag.ProjectID}))
                .DataKeys(keys =>
                {
                    keys.Add(s => s.ID);
                })
                .Columns(c =>
                {
                    c.Bound(item => item.EMail);
                })
                                            .Resizable(resizing => resizing.Columns(true))
                                            .Groupable()
                                            .Pageable(p => p.PageSize(20))
                                            .Sortable()
                                            .Filterable()
                                            .Scrollable(scrolling => scrolling.Height(350))
                        )

