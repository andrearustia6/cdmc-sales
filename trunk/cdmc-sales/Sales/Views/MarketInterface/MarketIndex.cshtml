@using Entity
@using Utl
@model List<Lead>
@Html.Partial("contenttitle", "客户邮箱")
@using (Html.BeginForm())
{
<div  style="margin:10px; margin-left:0px;">
    <span ><b>目标项目：</b>
    @{
        var ps = CH.GetAllData<Project>(p => p.Market == Employee.CurrentUserName);
        //var selected = ps.Count== 0 ? 0:ps.FirstOrDefault().ID;
        @Html.DropDownList("ProjectID", new SelectList(ps, "ID", "ProjectCode", ViewBag.ProjectID))
    }
    </span>

    <span ><b>出单情况：</b>
    @{
        @Html.DropDownList("DealCondition", SelectHelper.DealConditionSelectListInMarket((int?)ViewBag.DealCondition))
    }
    </span>
    
    <span ><b>目标项目类型：</b>
        @Html.DropDownList("ProjectType", new SelectList(CH.GetAllData<ProjectType>(), "ID", "Name", ViewBag.ProjectType), "-请选择-")
    </span>

    <span ><b>时区：</b>
        @Html.DropDownList("DistinctNumber", SelectHelper.DistinctNumberSelectList((int?)ViewBag.DistinctNumber), "中国(默认)")
    </span>
    <input type="submit" value="提交" />
</div>
}
@(Html.Telerik().Grid<Lead>(Model).Name("Lead")
    .ToolBar(
                commands => commands.Custom()
                    .HtmlAttributes(new { id = "export" })
                    .Text("导出excel格式数据")
                    .Action("EmailExportCsv", "MarketInterface", new { projectid = (int?)ViewBag.ProjectID, 
                                                                       projecttype = (int?)ViewBag.ProjectType, 
                                                                       dealcondition = (int?)ViewBag.DealCondition, 
                                                                       distinctnumber = (int?)ViewBag.DistinctNumber })
            )
    .DataKeys(keys =>
    {
        keys.Add(s => s.ID);
    })
    .Columns(c =>
    {
        c.Bound(item => item.EMail);
    })
    .Resizable(resizing => resizing.Columns(true))
    .Groupable()
    .Pageable(p => p.PageSize(20))
    .Sortable()
    .Filterable()
    .Scrollable(scrolling => scrolling.Height(350))
)

