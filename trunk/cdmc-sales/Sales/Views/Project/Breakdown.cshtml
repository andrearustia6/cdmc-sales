@{
    ViewBag.Title = "Breakdown";
}

@using Entity
@using Utl
@using BLL
@model List<Member>
@{ Html.BeginForm(); }
@Html.Hidden("projectid", (int)ViewBag.ProjectID)
@Html.Hidden("TargetOfMonthid", (int)ViewBag.TargetOfMonthID)
@Html.Hidden("OldStartDate", (string)ViewBag.StartDate)
<div>

<div style="margin: 10px; margin-left: 0px;">
        <b><span>
            <label> 开始时间：</label>
            @Html.Telerik().DatePicker().Name("StartDate").Value(ViewBag.StartDate as string)
            <span>~ </span>
            <label>
                结束时间：</label>
            @Html.Telerik().DatePicker().Name("EndDate").Value(ViewBag.EndDate as string)
            <span>  </span>
            <input type="submit" value="提交" />
        </span></b>
    </div>
<br />
<br />
<p><b>Deal In Target:</b></p>
<table class="tb_breakdown">
@if (Model != null)
{
    List<TargetOfWeek> vs = null;
    if (ViewBag.Targets != null)
    {
        vs = (List<TargetOfWeek>)ViewBag.Targets;
    }
    foreach (var m in Model)
    {
        decimal v=0;
        if (vs!=null)
        {
            var item = vs.FirstOrDefault(child => child.Member == @m.Name);
            if (item != null)
            {
                v = item.Deal;
            }
        }
            
            
      <tr><td>@m.Name</td><td>
      <div class="targetbreakdown" TargetOfWeek=@v ></div>
      </td><td><p>$@v</p><input type="hidden" mname=@m.Name value=@m.Name|@v  name="dealin" /></td></tr>
    
    }
}
</table>

<br />
<br />
<p><b>Check In Target:</b></p>
<table class="tb_breakdown">
@if (Model != null)
{
    List<TargetOfWeek> vs = null;
    if (ViewBag.Targets != null)
    {
        vs = (List<TargetOfWeek>)ViewBag.Targets;
    }
    foreach (var m in Model)
    {
        decimal v=0;
        if (vs!=null)
        {
            var item = vs.FirstOrDefault(child => child.Member == @m.Name);
            if (item != null)
            {
                v = item.CheckIn;
            }
        }
            
            
      <tr><td>@m.Name</td><td>
      <div class="targetbreakdown" TargetOfWeek=@v ></div>
      </td><td><p>$@v</p><input type="hidden" mname=@m.Name value=@m.Name|@v  name="checkin" /></td></tr>
    
    }
}
</table>
</div>
 <p> <button type="submit">@SR.Save</button></p>
@{ Html.EndForm(); }

@{ Html.Telerik().ScriptRegistrar().OnDocumentReady(@<text> 
        initialTargetbreakdown();
    </text>);
}
@Html.ValidationSummary(true)

<style type="text/css" >
.tb_breakdown
{
}
input[type=text]
{
	border:0; color:#f6931f; font-weight:bold;
}
.tb_breakdown tr td p
{
	max-width:150px;
}
.targetbreakdown
{
	width:300px;
	margin:15px;
}
 table
</style>