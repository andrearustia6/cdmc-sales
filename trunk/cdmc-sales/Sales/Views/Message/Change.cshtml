@using Entity
@using Utl
@model Message
@using BLL
<fieldset>
    <legend>@SR.Form</legend>
     <div class="editor-label">
        @Html.LabelFor(model => model.Question)
    </div>
    <div class="editor-field">
        @Html.EditorFor(model => model.Question)
        @Html.ValidationMessageFor(model => model.Question)
    </div>
    <div class="editor-label">
        @Html.LabelFor(model => model.ProjectID, "所属项目")
    </div>
    <div class="editor-field">
    @{
        var projectid = Model == null ? ViewBag.ProjectID as int? : Model.ProjectID;
        var p = CH.GetDataById<Project>(projectid);
        <p>@p.Name</p>
        @Html.Hidden("ProjectID", projectid)
       @* var ps = CRM_Logical.GetSalesInvolveProject();
        var lvl1 = Employee.GetCurrentRoleLevel();
        if (lvl1 != 5 && lvl1 <=100)
        {
            @Html.DropDownList("ProjectID", new SelectList(ps,"ID","ProjectCode"),"请选择")
            @Html.ValidationMessageFor(model => model.ProjectID)
        }
        else
        {
        @Html.DisplayFor(m=>m.Project.Name)
        @Html.HiddenFor(m=>m.ProjectID)
        }*@
    }
    </div>
 
  
    <div class="editor-label">
        @Html.LabelFor(model => model.Content)
    </div>
    <div class="editor-field">
        @Html.TextAreaFor(model => model.Content)
        @Html.ValidationMessageFor(model => model.Content)
    </div>
    @{
        @Html.HiddenFor(m => m.SalesTypeID)
         <div class="editor-label">
            @Html.LabelFor(model => model.FlowNumber)
        </div>
        <div class="editor-field">
            @Html.DisplayFor(model => model.FlowNumber)
        </div>
        
        var lvl = Employee.GetCurrentRoleLevel();
        if (lvl == 5 || (lvl != 5 && lvl > 100))
        {
        <div class="editor-label">
            @Html.LabelFor(model => model.Answer)
        </div>
        <div class="editor-field">
            @Html.TextAreaFor(model => model.Answer)
            @Html.ValidationMessageFor(model => model.Answer)
        </div>
        }
        else
        {
            <div class="editor-label">
            @Html.LabelFor(model => model.Answer)
        </div>
        <div class="editor-field">
            @Html.DisplayFor(model => model.Answer)
        </div>
        }
    }
</fieldset>
